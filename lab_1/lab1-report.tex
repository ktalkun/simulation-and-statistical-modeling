% arara: indent: {overwrite: yes}
\section{Лабораторная 1}

\subsection{Условие}

\textbf{Согласно варианту:} $\mathbf{X_{0} = \alpha = 16 807, K = 64}$.

Используя метод Маклерена-Марсальи построить датчик БСВ (1 датчик должен быть мультипликативно конгруэнтный, второй – на выбор). Исследовать точность построенной БСВ.

\begin{enumerate}
	\item Осуществить моделирование $n = 1000$ реализаций БСВ с помощью мультипликативного конгруэнтного метода (МКМ) с параметрами $X{0}, \alpha, m = 231$;
	\item Осуществить моделирование $n = 1000$ реализаций БСВ с помощью метода Макларена-Марсальи (один датчик должен быть мультипликативно конгруэнтный (п. 1), второй – на выбор).
	      $K$ – объем вспомогательной таблицы;
	\item Проверить точность моделирования обоих датчиков (п. 1 и п. 2) с помощью критерия согласия Колмогорова и $\chi^{2}$ - критерия Пирсона с уровнем значимости $\varepsilon = 0.05$.
\end{enumerate}

\subsection{Теория}
\subsubsection{Датчики БСВ}
Для моделирования на ЭВМ реализаций \textbf{\textit{Базовой случайной величины}} используются специальные программы, называемые программными датчиками БСВ.\\
В основе программных датчиков БСВ лежат рекуррентные формулы вида:

\begin{equation}
	x_{n} = \varphi (x_{n-1}, \ldots, x_{n-p}), n = 1, 2, \ldots ,
	\label{main_recurrent:ref}
\end{equation}

где $x_{1-p}, x_{2-p}, \ldots, x_{0}$ $(p \geqslant 1)$  - заданные стартовые значения. Описанное соотношение (\ref{main_recurrent:ref}) описывает детерминированный алгоритм, однако при соответствующем подборе преобразования $\varphi(\cdot)$ получаемые на его основе псевдослучайные числа ${x_{n}}$ по своим функциональным и числовым характеристикам близки к БСВ.

Алгоритмы моделирования вида (\ref{main_recurrent:ref}) обладают общим недостатком: начиная с некоторого момента $\mathbf{t_{0}}$, последовательность псевдослучайных чисел образует цикл, который повторяется бесконечное число раз. Длина $\mathbf{T}$ циклически повторяющейся последовательности называется \textbf{\textit{периодом датчика}} БСВ $(T \leq m - 1)$.

Период $\mathbf{T}$ и \textbf{\textit{коэффициент использования}} БСВ $\mathbf{k}$ являются основными показателями качества программных датчиков БСВ. Лучшим датчикам соответствуют большие значения $\mathbf{T}$ и $\mathbf{k}$.

\subsubsection {Линейный конгруэнтный метод}\label{linear_congruential_generator}
\textbf{Линейный конгруэнтный метод} - один из методов генерации псевдослучайных чисел. Применяется в простых случаях и не обладает криптографической стойкостью. Входит в библиотеки различных компиляторов.

Суть метода заключается в вычислении последовательности случайных чисел $X_n$ следующим образом:

\begin{equation}
	X_{n+1} = \frac{\alpha X_{n} + c) \bmod m}{m},
	\label{linear_congruential_generator_formula:ref}
\end{equation}

где:

\hfill\parbox{17.5cm}{
	$
		\left.
		\begin{array}{ccc}
			\begin{aligned}
				 & \text{1. } X_{0} \text{ - начальное значение } (0 \leqslant X_{0} < 1) \\
				 & \text{2. } \alpha \text{ - множитель } (0 \leqslant \alpha < m)        \\
				 & \text{3. } c \text{ - приращение } (0 \leqslant c < m )                \\
				 & \text{4. } m \geq 2 \text{ - модуль }                                  \\
			\end{aligned}
		\end{array}
		\right\}
	$ - \textbf{\textit{параметры датчика
	}}.
}\\\\

\textbf{Типовые значения параметров:} $m = 2^{31}, x_0 = \alpha = 65539$.

\subsubsection{Мультипликативный конгруэнтный метод}
Метод генерации \textit{линейной конгруэнтной последовательности} (раздел \ref{linear_congruential_generator}) при $\mathbf{c = 0}$ называют \textbf{\textit{мультипликативным конгруэнтным методом}}.

\subsubsection{Метод Макларена-Марсальи}
\textbf{\textit{Генератор Макларена-Марсальи}} - криптографически стойкий генератор псевдослучайных чисел, который основан на комбинации двух конгруэнтных генераторов и вспомогательной матрице, с помощью которой происходит перемешивание двух последовательностей, полученных от двух генераторов.

Данный генератор псевдослучайных чисел оперирует с тремя объектами: двумя конгруэнтными генераторами, которые порождают последовательности $\mathbf{\langle X_n \rangle, \langle Y_n \rangle}$, и массива $\mathbf{V}$, состоящей из $\mathbf{k}$ элементов, обычно $k \in \lbrace 64, 28, 256 \rbrace$. На выходе последовательность $\mathbf{\langle Z_n \rangle}$.

Генератор состоит из четырёх основных стадий:
\begin{enumerate}
	\item Инициализация $\mathbf{V}$ и $\mathbf{Z}$ первыми $\mathbf{k}$ элементами последовательности $\mathbf{\langle X_n \rangle}$ - выполняется один раз;
	\item Выборка $\mathbf{X, Y}$ из $\mathbf{\langle X_n \rangle, \langle Y_n \rangle}$, то есть $\mathbf{X, Y}$ - очередные члены последовательностей $\mathbf{\langle X_n \rangle, \langle Y_n \rangle}$;
	\item Вычисление $\mathbf{j = \lfloor k \cdot Y \rfloor}$, где $\mathbf{j \in [0,k)}$ - случайное число, определяемое $Y$;
	\item Присвоение $\mathbf{Z_i=V_i}$ и замена $\mathbf{V_j = X}$.
\end{enumerate}

Последние три стадии могут повторяться необходимое число раз.

Данный метод позволяет ослабить зависимость между членами последовательности $\mathbf{Z_n}$ и получить сколь угодно большие значения её периода $T$ при условии, что периоды $T_1, T_2$ исходных датчиков являются взаимно простыми числами. Коэффициент использования БСВ для данного датчика $\mathbf{k=\frac{1}{2}}$ (за исключением первой реализации, для моделирования которой используется $K+1$ реализация).
